Version 4
SHEET 1 2392 680
WIRE -16 -32 -48 -32
WIRE 112 -32 64 -32
WIRE -48 -16 -48 -32
WIRE 112 48 112 -32
WIRE 544 48 432 48
WIRE 784 48 544 48
WIRE 496 80 240 80
WIRE 1888 80 1728 80
WIRE 1360 96 1264 96
WIRE 1728 96 1728 80
WIRE 1728 96 1360 96
WIRE 784 112 784 48
WIRE 912 112 784 112
WIRE 1264 112 1264 96
WIRE 1264 112 912 112
WIRE 1728 192 1728 96
WIRE 1888 192 1888 160
WIRE 240 208 240 80
WIRE 288 208 240 208
WIRE 608 208 560 208
WIRE 1360 224 1360 176
WIRE 80 240 -16 240
WIRE 240 240 240 208
WIRE 240 240 160 240
WIRE 336 240 336 224
WIRE 432 240 432 48
WIRE 432 240 336 240
WIRE 656 240 656 224
WIRE 896 240 656 240
WIRE 1040 240 896 240
WIRE -80 256 -176 256
WIRE 336 256 336 240
WIRE 656 256 656 240
WIRE -176 272 -176 256
WIRE -176 272 -688 272
WIRE 64 272 -16 272
WIRE 160 272 144 272
WIRE 1888 304 1888 256
WIRE 160 336 160 272
WIRE 192 336 192 304
WIRE 192 336 160 336
WIRE 288 336 192 336
WIRE 496 336 496 80
WIRE 608 336 496 336
WIRE 1040 336 1040 240
WIRE 1040 336 992 336
WIRE 336 368 336 352
WIRE 656 368 656 352
WIRE 1040 384 1040 336
WIRE 1360 384 1040 384
WIRE 1360 384 1360 304
WIRE 1376 384 1360 384
WIRE 1520 384 1456 384
WIRE 1728 384 1728 256
WIRE 1728 384 1520 384
WIRE 1888 384 1728 384
WIRE 160 416 160 336
WIRE 560 416 560 208
WIRE 560 416 160 416
WIRE 1520 448 1520 384
FLAG 1520 448 isense
FLAG -80 288 0
FLAG -48 64 0
FLAG 336 368 0
FLAG 336 128 vdc
FLAG 656 128 vdc
FLAG 656 368 0
FLAG 912 112 black
FLAG 992 336 red
FLAG -320 48 0
FLAG -320 -32 3.3v
FLAG -688 352 0
FLAG 544 112 0
FLAG 896 304 0
FLAG 544 -16 vdc
FLAG 896 176 vdc
FLAG 112 48 vdc
SYMBOL cap 1712 192 R0
SYMATTR InstName C3
SYMATTR Value 1.1n
SYMBOL cap 1872 192 R0
SYMATTR InstName C4
SYMATTR Value 374p
SYMBOL res 1872 288 R0
SYMATTR InstName R3
SYMATTR Value 63
SYMBOL ind 1872 64 R0
SYMATTR InstName L1
SYMATTR Value 76m
SYMBOL res 1472 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 0.1
SYMBOL res 1344 80 R0
SYMATTR InstName R5
SYMATTR Value 90k
SYMBOL res 1344 208 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL Digital/schmitt -80 192 R0
WINDOW 3 -89 -2 Left 2
SYMATTR Value Vhigh=200 vlow=0 ref=0.5
SYMATTR InstName A1
SYMBOL nmos 288 128 R0
SYMATTR InstName M1
SYMATTR Value BSC600N25NS3
SYMBOL nmos 288 256 R0
SYMATTR InstName M2
SYMATTR Value BSC600N25NS3
SYMBOL voltage -48 -32 R0
SYMATTR InstName V2
SYMATTR Value 170
SYMBOL nmos 608 128 R0
SYMATTR InstName M3
SYMATTR Value BSC600N25NS3
SYMBOL nmos 608 256 R0
SYMATTR InstName M4
SYMATTR Value BSC600N25NS3
SYMBOL voltage -320 -48 R0
SYMATTR InstName V1
SYMATTR Value 3.3
SYMBOL voltage -688 256 R0
SYMATTR InstName V3
SYMATTR Value SINE(.5 .3 29.8khz)
SYMBOL res 80 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10
SYMBOL diode 560 48 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value RF2001NS2D
SYMBOL diode 560 112 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value RF2001NS2D
SYMBOL diode 912 240 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value RF2001NS2D
SYMBOL diode 912 304 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value RF2001NS2D
SYMBOL res 176 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1
SYMBOL res 160 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1
TEXT 1720 40 Left 2 ;piezoelectric element model - 28k
TEXT 1352 464 Left 2 ;current sense
TEXT 1296 56 Left 2 ;voltage sense
TEXT 168 544 Left 2 !.tran 1 .6m .5m
TEXT 152 592 Left 2 ;.step param l list 1e-20 1m
TEXT 936 -24 Left 2 ;9mH for single inductor - adds resonance for square harmonic
TEXT -240 136 Left 2 ;variable square wave generator
TEXT 296 -8 Left 2 ;H-bridge driver
TEXT -160 -80 Left 2 ;high voltage dc supply
TEXT 168 632 Left 2 ;.step param c list 1e-20 2.4n
RECTANGLE Normal 204 28 852 456 2
RECTANGLE Normal 1676 68 1988 428 2
RECTANGLE Normal 1240 84 1496 308 2
RECTANGLE Normal 1316 328 1496 448 2
RECTANGLE Normal 948 64 1092 164 2
RECTANGLE Normal -256 160 128 416 2
